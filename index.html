<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Recompound Strategy</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
  <link rel="icon" type="image/png" href="logo.jpg" />
  <meta property="og:title" content="Recompound Strategy">
  <meta property="og:description" content="From refugee legacy to financial freedom. Strategy, ownership, and real wealth.">
  <meta property="og:image" content="logo.jpg">
  <meta name="description" content="Recompound Strategy is a mission-driven platform proving you can build wealth from zero through ownership and reinvestment.">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    html { scroll-behavior: smooth; }

    :root {
      --accent: #4faaff;
      --accent2: #3052e6;
      --text-dark: #161d2b;
      --hero-bg: #16181e;
      --section-white: #fff;
      --section-gray: #f5f7fa;
      --footer-bg: #13151b;
      --footer-text: #fff;
      --max-width: 1100px;
    }
.chart-controls-card.chart-overlay-panel {
  background: transparent !important;
  box-shadow: none !important;
  border: none !important;
  border-radius: 18px !important;
  position: absolute !important;
  top: 36px !important;
  left: 0 !important;
  z-index: 10 !important;
  min-width: 290px !important;
  max-width: 350px !important;
  width: 325px !important;
  margin: 0 !important;
  padding: 1.3rem 1rem 1rem 1rem !important;
}


.chart-flex-row {
  position: relative;
}

    /* --- ANIMATED FADE UP ON SCROLL --- */
    .scroll-fade {
      opacity: 0;
      transform: translateY(60px);
      transition: opacity 0.9s cubic-bezier(.7,.2,.2,1), transform 0.9s cubic-bezier(.7,.2,.2,1);
    }
    .scroll-fade.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* --- KPI COUNTER BLINK --- */
    .kpi-number.animated {
      animation: kpi-pop 0.6s cubic-bezier(.7,.2,.2,1);
    }
    @keyframes kpi-pop {
      0% { color: #fff; transform: scale(1.09);}
      40% { color: var(--accent2); transform: scale(1.17);}
      100% { color: var(--accent); transform: scale(1);}
    }

    /* --- PREMIUM BUTTON --- */
    .premium-btn {
      background: linear-gradient(93deg, #4faaff 20%, #3052e6 100%);
      color: #fff;
      font-weight: 700;
      border-radius: 50px;
      padding: 1.13rem 2.8rem;
      font-size: 1.18rem;
      border: none;
      outline: none;
      box-shadow: 0 4px 18px #4faaff22;
      transition: background 0.3s, box-shadow 0.2s, transform 0.15s;
      cursor: pointer;
    }
    .premium-btn:hover {
      background: linear-gradient(93deg, #3052e6 10%, #4faaff 90%);
      box-shadow: 0 12px 32px #4faaff55;
      transform: scale(1.05);
    }
    .floating-cta {
      position: fixed;
      bottom: 30px;
      right: 24px;
      z-index: 9999;
      box-shadow: 0 2px 16px #4faaff1e;
    }

    html, body {
      background: #101522 !important;
      color: var(--text-dark);
      font-family: 'Inter', sans-serif;
      margin: 0; padding: 0;
      min-height: 100vh;
      box-sizing: border-box;
      width: 100vw;
      max-width: 100vw;
      overflow-x: hidden;
    }

    /* MOBILE NAVBAR STYLES */
    @media (max-width: 700px) {
      .navbar {
        padding: 0 !important;
        height: 44px !important;
        min-height: 0 !important;
        max-height: 48px !important;
        box-shadow: 0 2px 12px 0 #23242b44;
      }
      .nav-content {
        padding: 0 4px !important;
        height: 44px !important;
        min-height: 0 !important;
        max-height: 48px !important;
        display: flex;
        align-items: center !important;
        justify-content: space-between !important;
      }
      .nav-logo {
        height: 28px !important;
        margin: 0 5px 0 5px !important;
        display: block !important;
        opacity: 1 !important;
        pointer-events: auto !important;
        position: relative;
        z-index: 10001;
      }
      .burger {
        margin: 0 5px 0 0 !important;
        padding: 6px 10px !important;
        height: 32px !important;
        width: 38px !important;
        font-size: 1.2rem !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
      }
    }

    .navbar {
      position: fixed; top: 0; left: 0; width: 100vw;
      background: linear-gradient(120deg, #232842 0%, #25325a 55%, #3053a5 80%, #4faaff 100%);
      background-size: 200% 200%;
      animation: gradientMove 8s linear infinite;
      z-index: 100; padding: 0.5rem 0;
      box-shadow: 0 3px 24px 0 rgba(0,0,0,0.20);
      border-bottom: 1.5px solid #23242b;
      transition: box-shadow 0.2s;
    }
    .nav-content {
      display: flex;
      align-items: center;
      justify-content: space-between;
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 2rem;
      width: 100%;
      position: relative;
    }
    .nav-center {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: auto;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2.2rem;
    }
    .nav-logo-hide {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s;
    }
    .nav-logo-show {
      opacity: 1;
      pointer-events: auto;
      transition: opacity 0.25s;
    }
    .nav-cta {
      background: none !important;
      border: none;
      color: #fff;
      font-weight: 700;
      font-size: 1rem;
      margin-left: 2.2rem;
      letter-spacing: .02em;
      text-decoration: none;
      border-bottom: 2px solid transparent !important;
      transition: color 0.18s, border-bottom 0.18s, background 0.18s, box-shadow 0.18s, transform 0.18s;
      cursor: pointer;
      display: inline-block;
      position: relative;
      z-index: 1;
      box-shadow: none;
      padding: 0 0 2px 0;
    }
    .nav-cta:hover,
    .nav-cta:focus {
      color: var(--accent) !important;
      border-bottom: 2px solid var(--accent) !important;
      background: none !important;
      box-shadow: none !important;
      transform: scale(1.05);
    }
    .nav-menu a,
    .nav-cta {
      color: #fff;
      font-weight: 700;
      font-size: 1rem;
      text-decoration: none;
      border-bottom: 2px solid transparent;
      background: none !important;
      transition:
        color 0.18s,
        border-bottom 0.18s,
        transform 0.18s cubic-bezier(.7,.2,.2,1),
        box-shadow 0.18s cubic-bezier(.7,.2,.2,1);
      box-shadow: none !important;
      display: inline-block;
      padding: 0 0 2px 0;
    }
    .nav-menu a:hover,
    .nav-menu a:focus,
    .nav-menu a.active,
    .nav-cta:hover,
    .nav-cta:focus {
      color: var(--accent) !important;
      border-bottom: 2px solid var(--accent) !important;
      background: none !important;
      transform: scale(1.07) translateY(-2px);
      box-shadow: none !important;
    }
    .nav-logo { height: 44px; border-radius: 8px; }

    .hero-section {
      width: 100vw;
      min-height: 540px;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      z-index: 1;
      text-align: center;
      padding-top: 6.7rem;
      padding-bottom: 4.5rem;
      color: #fff;
      background: linear-gradient(135deg, #13162c 0%, #101522 85%);
      position: relative;
      overflow: hidden;
    }
    .hero-section::after {
      content: "";
      position: absolute;
      left: 0; right: 0; bottom: 0;
      height: 120px;
      background: url('https://www.svgbackgrounds.com/wp-content/uploads/2021/06/wave-haikei-3.svg') center bottom repeat-x;
      opacity: 0.15;
      pointer-events: none;
      z-index: 0;
    }
    .glass-premium {
      background: rgba(25, 42, 76, 0.44);
      backdrop-filter: blur(13px) brightness(1.14);
      border-radius: 18px;
      box-shadow: 0 6px 32px 0 #4faaff3c, 0 1.5px 12px #fff2;
      border: 1.6px solid #277bfa2a;
      margin-top: 0.8rem;
      margin-bottom: 0.8rem;
      transition: box-shadow 0.25s, border-color 0.18s;
    }

    @keyframes gradientMove {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .hero-section .logo {
      width: 155px;
      margin: 1.2rem auto 0.8rem;
      display: block;
      border-radius: 18px;
      background: transparent;
      border: none;
      padding: 0;
    }

    .hero-section h1 {
      font-size: 3.2rem;
      font-weight: 800;
      margin-bottom: .55rem;
      background: linear-gradient(90deg,#4faaff 20%,#fff 100%);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      letter-spacing: 0.01em;
      animation: fadeInUp 1s cubic-bezier(.7,.2,.2,1);
    }
    .hero-section h2 {
      font-size: 1.31rem;
      font-weight: 700;
      opacity: .99;
      margin-bottom: 2.2rem;
      color: #e4f3ff;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(32px);}
      to { opacity: 1; transform: translateY(0);}
    }
    .hero-btn {
      display: inline-block;
      margin: 1.9rem auto 1.5rem auto;
      padding: 1.12rem 2.85rem;
      border-radius: 40px;
      font-size: 1.18rem;
      font-weight: 700;
      background: linear-gradient(90deg,#4faaff 40%,#3052e6 100%);
      color: #fff;
      text-decoration: none;
      transition: background .3s, color .2s, transform .2s;
      box-shadow: 0 3px 18px 0 #277bfa19;
      border: none;
      letter-spacing: .08em;
      outline: none;
    }
    .hero-btn:hover, .contact-btn:hover {
      background: linear-gradient(90deg,#3052e6 10%,#4faaff 90%);
      box-shadow: 0 10px 26px 0 #4faaff33;
      transform: scale(1.05);
      color: #fff;
      text-decoration: none;
    }

    .accent-bar, footer {
      background: linear-gradient(120deg, #11131a 0%, #1a2234 55%, #223259 80%, #245cf4 100%);
      background-size: 200% 200%;
      animation: gradientMove 8s ease-in-out infinite;
    }
    .kpi-row {
      display: flex;
      justify-content: center;
      gap: 2.5rem;
      margin: 2.3rem 0 0.8rem;
      flex-wrap: wrap;
    }
    .kpi-card {
      background: rgba(34,44,68,0.60);
      border-radius: 13px;
      box-shadow: 0 2px 22px 0 #4faaff22;
      padding: 1.21rem 2.55rem;
      min-width: 110px;
      text-align: center;
      backdrop-filter: blur(7px) brightness(1.15);
      transition: box-shadow .2s, transform .18s;
      border: 1.5px solid #27396e19;
      cursor: pointer;
    }
    .kpi-card:hover {
      box-shadow: 0 6px 32px 0 #4faaff6a, 0 1px 9px #fff3;
      transform: scale(1.037);
      border-color: #4faaff57;
      z-index: 2;
    }
    .kpi-number {
      font-size: 2.19rem;
      font-weight: 800;
      color: var(--accent);
      letter-spacing: .01em;
      text-shadow: 0 2px 14px #277bfa29;
      display: block;
      margin-bottom: 0.12rem;
      font-variant-numeric: tabular-nums;
    }
    .kpi-label {
      color: #c0d9f9;
      font-size: 1.07rem;
      margin-top: .08rem;
      font-weight: 700;
      letter-spacing: .01em;
      display: block;
    }
    section, .testimonial-section, .about-bottom-inner, .chart-content-fade {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
      will-change: auto !important;
    }
    .site-section, .site-section.alt {
      width: 100vw;
      background: #101522;
      margin: 0;
      padding: 0;
      border-radius: 0;
      box-shadow: none;
      display: block;
    }
    .site-section.alt { background: linear-gradient(90deg, #f5f7fa 90%, #e4f3ff 100%);}
    .section-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 3.2rem 1.5rem 1.5rem 1.5rem;
    }
    .site-section:not(:first-child) {
      /* border-top: 1px solid #eaeaea; */
    }
    .site-section h3 {
      font-size:2.09rem;
      margin-bottom:1.2rem;
      color: var(--accent2);
      font-weight: 800;
      letter-spacing: 0;
    }
    .site-section ul { margin-left:1.3rem; }
    .testimonial-section {
      margin: 2.6rem 0 2.7rem 0;
      text-align: center;
      background: none;
      border: none;
    }
    .testimonial-quote {
      font-size: 1.39rem; color: #fff; font-style: italic;
      font-weight: 800; display: block; margin-bottom: 0.8rem;
      letter-spacing: 0;
    }
    .testimonial-author { color: #3052e6; font-weight: 700; font-size: 1.08rem; }
    .chart-section {
      width: 100vw;
      background: #101522 !important;
      margin: 0;
      box-shadow: 0 2px 24px 0 #277bfa0d;
      display: block;
      min-height: 440px;
      position: relative;
    }
   .chart-section-inner {
  max-width: 100vw !important;
  padding-top: 2.5rem !important;
  padding-bottom: 0 !important; /* Remove bottom padding */
  position: relative;
  overflow: visible !important;
  min-height: 600px !important;
}
    .chart-section canvas {
      max-width: 100%;
      width: 100%;
      margin: 1.3rem auto 0 auto;
      display: block;
      background: transparent;
    }
    @media (max-width: 850px) {
      .chart-section canvas {
        min-height: 260px !important;
        height: 320px !important;
        max-height: 320px !important;
      }
    }
    .about-bottom {
      width: 100vw;
      background: #101522 !important;
      padding: 0;
      margin: 0;
    }
    .about-bottom-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 3rem 1.5rem 1.2rem 1.5rem;
      text-align: center;
    }
    .about-bottom-inner h3 {
      font-size: 2.1rem;
      color: var(--accent2);
      font-weight: 800;
      margin-bottom: 1.1rem;
    }
    .contact-btn {
      display: inline-block;
      background: linear-gradient(90deg, #4faaff 40%, #3052e6 100%);
      color: #fff;
      font-weight: 700;
      font-size: 1.16rem;
      padding: 1rem 2.5rem;
      border-radius: 40px;
      margin: 1.2rem 0 0.2rem 0;
      text-decoration: none;
      box-shadow: 0 2px 12px 0 #4faaff22;
      transition: background 0.18s, transform 0.14s;
    }
    .whatsapp-btn {
      display: inline-block;
      background: #25D366;
      color: #fff;
      font-weight: 700;
      font-size: 1.16rem;
      padding: 1rem 2.5rem;
      border-radius: 40px;
      margin: 1.2rem 0 0.2rem 12px;
      text-decoration: none;
      box-shadow: 0 2px 12px 0 #25D36644;
      transition: background 0.18s, transform 0.14s;
    }
    .whatsapp-btn:hover {
      background: #1da851;
      transform: scale(1.04);
    }
    .chart-section { margin-bottom: 0; }
    footer {
      width: 100vw;
      background: linear-gradient(120deg, #11131a 0%, #1a2234 50%, #223259 70%, #245cf4 100%);
      background-size: 200% 200%;
      animation: gradientMove 8s ease-in-out infinite;
      text-align: center;
      padding: 2.2rem 1rem 1.4rem 1rem;
      font-size: 1.07rem;
      color: var(--footer-text);
      border-radius: 0;
      margin: 0;
      box-shadow: none;
      letter-spacing: 0.01em;
      min-height: 620px !important;
    }
    .footer-row { 
      display: flex; flex-wrap: wrap; justify-content: center; align-items: center; gap: 1.4rem; margin: 0 auto; max-width: 900px;
    }
    .footer-link { color: #4faaff; font-size: 1.04rem; text-decoration: underline;}
    .footer-link:hover { color: var(--accent2);}
    .footer-socials {
      display: flex; gap: 1.1rem; align-items: center;
    }
    .footer-socials a { color: #4faaff; font-weight: 700; font-size: 1.13rem; text-decoration:none; display:flex; align-items:center;}
    .footer-socials a:hover { color: var(--accent);}
    .footer-socials svg { margin-right: 6px; vertical-align: middle;}
    /* FADE IN EFFECT */
    .fade-in {
      opacity: 0;
      transform: translateY(40px);
      transition: opacity 1.2s cubic-bezier(.7,.2,.2,1), transform 1.2s cubic-bezier(.7,.2,.2,1);
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }
    /* ------------------- MOBILE IMPROVEMENTS ------------------- */
    @media (max-width: 900px) {
      .section-inner, .chart-section-inner, .about-bottom-inner { padding: 1rem 0.5rem 1.2rem 0.5rem; }
    }
    @media (max-width: 600px) {
      html, body {
        width: 100vw;
        max-width: 100vw;
        overflow-x: hidden;
      }
      .section-inner,
      .about-bottom-inner,
      .chart-section-inner {
        padding: 1.2rem 0.7rem 1.1rem 0.7rem !important;
      }
      .hero-section {
        padding-left: 0.7rem !important;
        padding-right: 0.7rem !important;
      }
      .navbar ul {
        padding-left: 0.2rem;
        padding-right: 0.2rem;
      }
      .site-section h3, .chart-section h3, .about-bottom-inner h3 { font-size: 1.3rem; }
      .contact-btn, .whatsapp-btn { padding: 0.75rem 1.2rem; font-size: 1rem; }
      .footer-row { flex-direction: column; gap: 0.7rem;}
    }

    body *::-webkit-scrollbar {
      display: none !important;
      width: 0 !important;
      height: 0 !important;
      background: transparent !important;
    }

    .site-section {
      background: #181e2d !important;   /* Deep blue-gray */
      margin-top: 0 !important;
      padding-top: 0 !important;
    }
    .chart-section {
      background: #151a27 !important;   /* Slightly bluer, premium */
    }

    .site-section p, .site-section ul li,
    .about-bottom-inner p,
    .chart-section h3,
    .site-section ul li {
      color: #fff !important;
    }

    .site-section h3, .about-bottom-inner h3 {
      color: var(--accent2) !important;
    }
    body, html {
      background: #101522 !important;
    }
    .site-section h3,
    .about-bottom-inner h3,
    .testimonial-author {
      color: #4faaff !important; 
      font-weight: 800;
      letter-spacing: 0.01em;
    }
    @media (max-width: 700px) {
      .hero-section {
        padding-top: 54px !important;
      }
    }

    @media (max-width: 400px) {
      .hero-section {
        padding-top: 3.5rem !important;
      }
    }
    /* REMOVE BULLET POINTS & RESET LIST STYLES FOR NAV MENU */
    .nav-menu {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      gap: 2.2rem;
      align-items: center;
    }
    @media (max-width: 700px) {
      .nav-center {
        position: static !important;
        left: 0 !important;
        transform: none !important;
        width: 100vw !important;
        justify-content: flex-start;
        align-items: flex-start;
        gap: 0;
        padding: 0;
      }
      .nav-menu {
        position: fixed !important;
        top: 44px;
        left: 0;
        width: 100vw !important;
        height: calc(100vh - 44px);
        background: linear-gradient(120deg, #232842 0%, #25325a 55%, #3053a5 80%, #4faaff 100%);
        flex-direction: column;
        align-items: flex-start;
        z-index: 9999;
        display: none;
        padding: 2.2rem 0 0 0;
        margin: 0;
        box-shadow: 0 6px 32px #25325a33;
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
      }
      .nav-menu.open {
        display: flex !important;
      }
      .nav-menu a {
        font-size: 1.07rem;
        font-weight: 700;
        padding: 0.75rem 1.5rem;
        color: #fff;
        width: 100vw;
        text-align: left;
        border-bottom: 1px solid #2c3855;
        border-radius: 0;
        background: none;
      }
      .nav-menu a:last-child {
        border-bottom: none;
      }
    }
    .nav-menu li {
      list-style: none;
      margin: 0;
      padding: 0;
    }
    .burger {
      display: none;
    }
    @media (max-width: 700px) {
      .burger {
        display: block;
        background: #c7e5ff;
        color: #3052e6;
        border: none;
        border-radius: 8px;
        padding: 7px 13px 8px 13px;
        font-size: 1.4rem;
        font-weight: 900;
        margin-left: auto;
        margin-right: 0.3rem;
        margin-top: 6px;
        cursor: pointer;
        box-shadow: 0 2px 8px #4faaff29;
        z-index: 2000;
        transition: background 0.18s, color 0.18s, transform 0.15s;
      }
      .burger.active,
      .burger:active {
        background: #4faaff;
        color: #fff;
        transform: scale(1.08);
      }
    }
    #backToTop {
      bottom: 10px !important;
      position: fixed !important;
    }
    #dcaChart {
  width: 100vw !important;
  max-width: 100vw !important;
  height: 600px !important;
  display: block !important;
  background: transparent !important;
  margin: 0 !important;        /* No margin */
  padding: 0 !important;       /* No padding */
  box-sizing: border-box;
}

    @media (max-width: 850px) {
      #dcaChart {
        min-height: 200px !important;
        height: 260px !important;
        max-height: 320px !important;
      }
    }
    @media (max-width: 850px) {
      #dcaChart, #dcaChart canvas {
        min-height: 260px !important;
        height: 320px !important;
        max-height: 320px !important;
      }
      #dcaResult {
        font-size: 1rem !important;
        padding: 13px 10px !important;
        left: 10px !important;
        top: 12px !important;
      }
    }
    #cityYield,
    #dcaStartYear,
    #dcaLumpSum {
      font-size: 1.14rem;
      border-radius: 8px;
      padding: 6px 16px;
      background: #1a2234;           
      border: 1.5px solid #277bfa99; 
      color: #fff;                 
    }
    #dcaStartYear {
      margin-left: 0.3em;           
    }
    #dcaLumpSum {
      width: 120px;                  
      text-align: right;             
    }
    .tab-btn {
  font-weight: 700;
  font-size: 1.08rem;
  color: #aeeaff;
  background: none;
  border: none;
  border-radius: 8px;
  padding: 0.54rem 1.31rem;
  transition: background .2s, color .18s, transform .15s, box-shadow .2s;
  cursor: pointer;
  outline: none;
}
.tab-btn.active,
.tab-btn:hover {
  background: linear-gradient(90deg, #4faaff 20%, #3052e6 100%);
  color: #fff;
  box-shadow: 0 2px 8px #4faaff36;
  transform: scale(1.03);
}
.chart-select,
.chart-input {
  border-radius: 7px;
  padding: 6px 13px;
  background: #101b2d;
  border: 1.5px solid #277bfa77;
  color: #fff;
  font-size: 1.08rem;
  font-weight: 600;
}
.result-panel {
  font-size: 1.17rem;
  background: #151a2b;
  border-radius: 10px;
  padding: 13px 9px 10px 9px;
  box-shadow: 0 1px 10px #4faaff19;
  margin-bottom: 1.2rem;
}
@media (max-width: 600px) {
  .chart-controls-card {
    padding: 0.7rem 0.3rem 0.6rem 0.3rem !important;
    min-width: 0 !important;
  }
  #controlsContainer,
  #controlsContainer form {
    flex-direction: column !important;
    align-items: stretch !important;
    gap: 0.8rem !important;
  }
  .tab-btn { width: 100%; font-size: 1.07rem;}
  .result-panel { font-size: 1.04rem; padding: 10px 5px 8px 5px;}
}
.chart-flex-row {
  display: flex;
  flex-direction: row;
  gap: 2.2rem;
  align-items: flex-start;
  justify-content: center;
  width: 100%;
  max-width: 1100px;
  margin: 0 auto;
}

.chart-canvas-container {
  width: 100% !important;
  margin: 0 !important;
  padding: 0 !important;
}

.chart-canvas-container canvas {
  width: 100% !important;
  max-width: 100%;
  min-height: 300px;
  height: 380px;
  margin: 0 auto;
  background: transparent;
  box-shadow: none;
  border-radius: 0;
}

@media (max-width: 900px) {
  .chart-flex-row {
    flex-direction: column;
    gap: 1.2rem;
  }
  .chart-canvas-container {
    min-width: 0;
    width: 100%;
    justify-content: center;
  }
  .chart-controls-card {
    max-width: 100%;
    margin: 0 auto;
  }
}

  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-content">
      <img src="logo.jpg" class="nav-logo nav-logo-hide" alt="Logo" />
      <button class="burger" id="burgerBtn" aria-label="Menu">&#9776;</button>
      <div class="nav-center">
        <ul class="nav-menu" id="mainNavMenu">
          <li><a href="#home" class="active">Home</a></li>
          <li><a href="#mission">Mission</a></li>
          <li><a href="#vision">Vision</a></li>
          <li><a href="#comparisonChartSection">Chart</a></li>
          <li><a href="#about-bottom">About</a></li>
          <li><a href="#contact-bottom" class="nav-cta">Let's Talk</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero-section" id="home">
    <img src="logo.jpg" alt="Recompound Strategy Logo" class="logo fade-in">
    <h1 class="fade-in">Recompound Strategy</h1>
    <h2 class="fade-in">Where Capital Becomes Ownership<br>And Ownership Becomes Freedom</h2>
    <div class="kpi-row fade-in">
      <div class="kpi-card">
        <span class="kpi-number" data-to="34"></span>
        <span class="kpi-label">Years of Data</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-number percent" data-to="346"></span>
        <span class="kpi-label">HPI Increase</span>
      </div>
      <div class="kpi-card">
        <span class="kpi-number percent" data-to="139"></span>
        <span class="kpi-label">CPI Inflation</span>
      </div>
    </div>
    <p class="fade-in" style="color:#aeeaff; font-weight:600; margin-top:1rem;">
      Start compounding today — even with limited capital.
    </p>
  </section>
  <div class="accent-bar"></div>

  <!-- Main Content Sections -->
  <div class="site-section">
    <div class="section-inner">
      <!-- Mission Section -->
      <section id="mission">
        <h3>My Mission</h3>
        <div class="section-divider"></div>
        <p>
          <b>Recompound Strategy</b> was founded to reclaim everything my family lost from being refugees twice, losing our business savings, and falling into debt caused by a corrupt government during the financial collapse. I come from survival, not privilege. My mission is to fight corruption, break out of this rigged system, and prove that wealth can be built from zero. Through strategy, ownership, and relentless reinvestment, I’m building real freedom outside the Matrix.
        </p>
      </section>
      <!-- Vision Section -->
      <section id="vision">
        <h3>Core Belief</h3>
        <div class="section-divider"></div>
        <p>
          <b>Recompound Strategy is built on one core belief:</b>
        </p>
        <p>You don’t need millions to build wealth you need assets that compound faster than inflation!</p>
        <p>
          Through strategic, recurring investments in fractional real estate, I’m compounding income every single month. Every share I own generates cash flow. Every reinvestment multiplies it. It’s real ownership, backed by real assets. And by holding hard assets, I stay in full control, even if the banks collapse.
        </p>
      </section>
      <!-- Extended Vision Section -->
      <section>
        <h3>Vision</h3>
        <div class="section-divider"></div>
        <p><b>Applying the timeless principles of Warren Buffett but in real estate</b></p>
        <ul>
          <li>Long term ownership</li>
          <li>Monthly income</li>
          <li>Relentless reinvestment</li>
        </ul>
        <p>
          While others chase hype, I build a fortress one brick at a time. This is the Buy-Hold-Recompound model. No shortcuts. No selling. Just exponential outcomes.
        </p>
      </section>
      <!-- Testimonial Section -->
      <section class="testimonial-section">
        <blockquote>
          <span class="testimonial-quote">
            “The first rule of compounding: Never interrupt it unnecessarily.”
          </span>
          <span class="testimonial-author">— Charlie Munger</span>
        </blockquote>
      </section>
    </div>
  </div>
<!-- Chart Section (Live DCA Backtest, overlay controls on chart) -->
<section class="chart-section" id="comparisonChartSection" style="margin-top:0;">
  <div class="chart-section-inner" style="max-width:100vw; padding: 2.5rem 0; position: relative; overflow: visible;">
    <h3 id="chartTitle" style="font-weight:800; font-size:2.2rem; color:var(--accent); margin-bottom:1.2rem;">
      Real Estate vs Cash (Live DCA Backtest)
    </h3>
    <p id="chartSubtitle" style="color:#aeeaff; font-size:1.14rem; font-weight:700; margin-bottom:1.1rem;">
      See what happens when you invest a lump sum in real estate vs. hold cash, using real <b>US HPI & CPI</b> data since 1990.
    </p>

    <!-- Container for canvas + overlay controls -->
    <div style="position: relative; width: 100vw; max-width: 100vw; min-height: 520px;">
      <!-- Chart canvas fills entire container -->
      <canvas id="dcaChart" height="520"
        style="
          width: 100vw !important;
          max-width: 100vw !important;
          height: 520px !important;
          display: block;
          background: transparent;
          box-shadow: none;
          border-radius: 0;
          margin: 0;
          padding: 0;
          ">
      </canvas>

      <!-- Overlay Controls Panel on left, transparent -->
      <div class="chart-controls-card chart-overlay-panel"
        style="
          background: transparent !important;
          box-shadow: none !important;
          border: none !important;
          border-radius: 18px !important;
          position: absolute !important;
          top: 36px !important;
          left: 0 !important;
          z-index: 10 !important;
          min-width: 290px !important;
          max-width: 350px !important;
          width: 325px !important;
          margin: 0 !important;
          padding: 1.3rem 1rem 1rem 1rem !important;
          ">
        <div style="text-align:left; margin-bottom:1.1rem;">
          <div style="display:inline-flex;gap:0.5rem; background:#1a2234; border-radius:12px; padding:0.22rem 0.22rem;">
            <button id="btnRealEstate" class="tab-btn active">Real Estate</button>
            <button id="btnBTC" class="tab-btn">Bitcoin</button>
            <button id="btnSP500" class="tab-btn">S&amp;P 500</button>
          </div>
        </div>
        <div style="text-align:left;margin-bottom:1rem;">
        </div>
        <div id="controlsContainer" style="display:flex;flex-direction:column;gap:0.7rem;justify-content:flex-start;align-items:flex-start;margin-bottom:1rem;">
          <!-- Real Estate Controls (default) -->
          <form id="dcaForm" style="display:flex;align-items:center;gap:0.7rem;flex-wrap:wrap;">
            <label for="cityYield" style="color:#aeeaff;font-weight:700;font-size:1.07rem;">City:</label>
            <select id="cityYield" class="chart-select"></select>
            <label for="dcaStartYear" style="color:#aeeaff;font-weight:700;">Start Year:</label>
            <select id="dcaStartYear" class="chart-select"></select>
            <label for="dcaLumpSum" style="color:#aeeaff;font-weight:700;">Invest:</label>
            <input id="dcaLumpSum" type="number" value="50000" min="1000" max="10000000" class="chart-input">
            <span style="color:#fff;font-weight:700;">€ (one time)</span>
          </form>
          <!-- BTC Controls -->
          <form id="btcForm" style="display:none;align-items:center;gap:0.7rem;flex-wrap:wrap;">
            <label for="btcStartYear" style="color:#aeeaff;font-weight:700;">Start Year:</label>
            <select id="btcStartYear" class="chart-select"></select>
            <label for="btcLumpSum" style="color:#aeeaff;font-weight:700;">Invest:</label>
            <input id="btcLumpSum" type="number" value="50000" min="1000" max="10000000" class="chart-input">
            <span style="color:#fff;font-weight:700;">€ (one time)</span>
          </form>
          <!-- SP500 Controls -->
          <form id="sp500Form" style="display:none;align-items:center;gap:0.7rem;flex-wrap:wrap;">
            <label for="sp500StartYear" style="color:#aeeaff;font-weight:700;">Start Year:</label>
            <select id="sp500StartYear" class="chart-select"></select>
            <label for="sp500LumpSum" style="color:#aeeaff;font-weight:700;">Invest:</label>
            <input id="sp500LumpSum" type="number" value="50000" min="1000" max="10000000" class="chart-input">
            <span style="color:#fff;font-weight:700;">€ (one time)</span>
          </form>
        </div>
        <!-- Result, NOT a box, just text -->
        <div id="dcaResult" style="font-size:1.13rem;color:#fff;font-weight:700;text-align:left;margin-bottom:0.5rem;margin-top:1.1rem;">
          <!-- JS fills this -->
        </div>
      </div>
    </div>
  </div>
</section>





  <!-- About/Contact Section -->
  <section id="about-bottom" class="site-section">
    <div class="section-inner">
      <h3>About</h3>
      <div class="section-divider"></div>
      <p style="font-size:1.17rem;font-weight:700;margin-bottom:1.45rem;">
        I’m not a Real Estate “Guru”.<br>
        I’m a strategist who started from zero and built a compounding real estate engine.
      </p>
      <h3 style="color:var(--accent);font-weight:800;letter-spacing:.01em;font-size:2.09rem;margin-bottom:1.2rem;">Co-Invest With Me</h3>
      <div class="section-divider"></div>
      <p style="font-size:1.07rem;margin-bottom:1.8rem;">
        I focus exclusively on long-term, wealth building real estate strategies never hype, never quick flips.<br><br>
        I’m open to select co-investment opportunities, strategic alliances, and fractional ownership structures with like minded capital partners.
        If you’re seeking to deploy capital in projects with real staying power and you value transparency, alignment, and compounding over time let’s connect.
      </p>
      <a href="https://wa.me/35796318896" target="_blank" class="contact-btn" style="margin-top:0.6rem;">
        Start a Conversation
      </a>
      <p style="font-size:0.98rem;color:#aeeaff;margin-top:1.1rem;">
        Foundations are built alone. Empires are built together.
      </p>
    </div>
  </section>

  <div id="contact-bottom"></div>
  
  <!-- Footer -->
  <footer>
    <div class="footer-row">
      <span>&copy; 2025 Recompound Strategy. All rights reserved.</span>
      <a href="#" class="footer-link">Privacy Policy</a>
      <span class="footer-socials">
        <a href="https://instagram.com/recompound_strategy" target="_blank">
          <!-- Instagram SVG Icon -->
          <svg width="21" height="21" viewBox="0 0 21 21" fill="none">
            <rect x="3" y="3" width="15" height="15" rx="5" stroke="currentColor" stroke-width="2"/>
            <circle cx="10.5" cy="10.5" r="3" stroke="currentColor" stroke-width="2"/>
            <circle cx="15.5" cy="5.5" r="1" fill="currentColor"/>
          </svg>
          Instagram
        </a>
        <a href="mailto:info@recompoundstrategy.com">
          <!-- Mail SVG Icon -->
          <svg width="21" height="21" viewBox="0 0 21 21" fill="none">
            <rect x="3" y="5" width="15" height="11" rx="3" stroke="currentColor" stroke-width="2"/>
            <path d="M4 7l6.5 5 6.5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Email
        </a>
      </span>
    </div>
  </footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Always scroll to top on refresh (even if URL has anchor/hash)
if ('scrollRestoration' in history) {
  history.scrollRestoration = 'manual';
}
window.onbeforeunload = function () {
  window.scrollTo(0, 0);
};

    function replaceChartCanvas() {
  const oldCanvas = document.getElementById('dcaChart');
  if (!oldCanvas) return;
  const parent = oldCanvas.parentNode;
  parent.removeChild(oldCanvas);

  const newCanvas = document.createElement('canvas');
  newCanvas.id = 'dcaChart';
  newCanvas.height = 380;
  newCanvas.style.maxWidth = '100%';
  newCanvas.style.width = '100%';
  newCanvas.style.margin = '1.3rem auto 0 auto';
  newCanvas.style.display = 'block';
  newCanvas.style.background = 'transparent';
  newCanvas.style.boxShadow = 'none';
  newCanvas.style.borderRadius = '0';

  parent.appendChild(newCanvas);

  // IMPORTANT: update global!
  window.dcaChartCtx = newCanvas.getContext('2d');
  window.dcaChart = null;
}

    // --- Main site JS: animation, nav, KPIs, etc. ---
    // Scroll-fade reveal
    window.addEventListener('scroll', function() {
      document.querySelectorAll('.scroll-fade').forEach(function(el) {
        const rect = el.getBoundingClientRect();
        if (rect.top < window.innerHeight - 80) el.classList.add('visible');
      });
    });
    window.dispatchEvent(new Event('scroll'));

    // Animated KPIs
    document.querySelectorAll('.kpi-number').forEach(el => {
      const target = +el.dataset.to;
      let cur = 0;
      const inc = Math.ceil(target / 70);
      const isPercent = el.classList.contains('percent');
      function update() {
        cur += inc;
        if (cur > target) cur = target;
        el.textContent = isPercent ? `${cur}%` : cur;
        el.classList.add('animated');
        setTimeout(() => el.classList.remove('animated'), 600);
        if (cur < target) requestAnimationFrame(update);
      }
      update();
    });

    // --- Nav link proximity highlight ---
    const navbar = document.querySelector('.navbar');
    const allNavLinks = Array.from(document.querySelectorAll('.nav-menu a'));

    const sectionEls = [
      document.getElementById('home'),
      document.getElementById('mission'),
      document.getElementById('vision'),
      document.getElementById('comparisonChartSection'),
      document.getElementById('about-bottom')
    ];

    let proximityActive = false;

    navbar.addEventListener('mousemove', function(e) {
      const mouseX = e.clientX;
      const mouseY = e.clientY;
      let closestIdx = -1;
      let minDist = Infinity;
      const maxDistance = 120;

      allNavLinks.forEach((a, i) => {
        const rect = a.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;
        const dist = Math.sqrt((mouseX - centerX) ** 2 + (mouseY - centerY) ** 2);
        if (dist < minDist) {
          minDist = dist;
          closestIdx = i;
        }
      });

      if (minDist > maxDistance) {
        allNavLinks.forEach(a => a.classList.remove('active'));
        proximityActive = false;
        return;
      }

      allNavLinks.forEach((a, i) => a.classList.toggle('active', i === closestIdx));
      proximityActive = true;
    });

    navbar.addEventListener('mouseleave', function() {
      proximityActive = false;
      updateActiveNav();
    });

    allNavLinks.forEach(link => {
      link.addEventListener('mouseenter', () => {
        allNavLinks.forEach(a => a.classList.remove('active'));
        link.classList.add('active');
        proximityActive = true;
      });
      link.addEventListener('mouseleave', () => {
        proximityActive = false;
        updateActiveNav();
      });
    });

    function updateActiveNav() {
  if (proximityActive) return;
  let curIdx = 0;
  for (let i = 0; i < sectionEls.length; i++) {
    if (sectionEls[i]) {
      const top = sectionEls[i].getBoundingClientRect().top;
      if (top < window.innerHeight * 0.22) curIdx = i;
    }
  }
  allNavLinks.forEach((a, i) => a.classList.toggle('active', i === curIdx));
  const backToTop = document.getElementById('backToTop');
  if (backToTop) {
    backToTop.style.display = window.scrollY > 350 ? 'block' : 'none';
  }
}

    window.addEventListener('scroll', updateActiveNav);
    window.addEventListener('DOMContentLoaded', updateActiveNav);

    // FADE IN HERO ELEMENTS ON LOAD
    window.addEventListener('DOMContentLoaded', function() {
      setTimeout(function() {
        document.querySelectorAll('.fade-in').forEach((el, i) => {
          setTimeout(() => el.classList.add('visible'), 150 + i * 110);
        });
      }, 100);
    });

    // LOGO SHOW/HIDE ON SCROLL (always show logo on mobile)
    window.addEventListener('scroll', function() {
      var navLogo = document.querySelector('.nav-logo');
      if (window.innerWidth <= 700) {
        navLogo.classList.remove('nav-logo-hide');
        navLogo.classList.add('nav-logo-show');
        return;
      }
      var heroSection = document.getElementById('home');
      var heroBottom = heroSection.getBoundingClientRect().bottom;
      if (heroBottom <= 80) {
        navLogo.classList.remove('nav-logo-hide');
        navLogo.classList.add('nav-logo-show');
      } else {
        navLogo.classList.remove('nav-logo-show');
        navLogo.classList.add('nav-logo-hide');
      }
    });

    // Burger menu toggle for mobile
    const burger = document.getElementById('burgerBtn');
    const navMenu = document.getElementById('mainNavMenu');
    burger.addEventListener('click', function(e) {
      navMenu.classList.toggle('open');
      burger.classList.toggle('active');
      e.stopPropagation();
    });
    // Close menu on link click (mobile only)
    document.querySelectorAll('.nav-menu a').forEach(link => {
      link.addEventListener('click', () => {
        if (window.innerWidth <= 700) navMenu.classList.remove('open');
        burger.classList.remove('active');
      });
    });
    // Click outside closes menu (mobile only)
    document.addEventListener('click', function(e) {
      if (window.innerWidth > 700) return;
      if (navMenu.classList.contains('open')) {
        if (!navMenu.contains(e.target) && e.target !== burger) {
          navMenu.classList.remove('open');
          burger.classList.remove('active');
        }
      }
    });
    // On resize, hide menu if desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth > 700) {
        navMenu.classList.remove('open');
        burger.classList.remove('active');
      }
    });
    // On page load, always close menu
    window.addEventListener('DOMContentLoaded', () => {
      navMenu.classList.remove('open');
      burger.classList.remove('active');
    });

    // Dynamically set divider width to match preceding h3
    function matchDividersToHeadings() {
      document.querySelectorAll('.section-divider').forEach(div => {
        const h3 = div.previousElementSibling;
        if (h3 && h3.tagName.startsWith('H')) {
          // Measure h3 width (including padding)
          const style = getComputedStyle(h3);
          const width = h3.offsetWidth
            + parseFloat(style.marginLeft)
            + parseFloat(style.marginRight);
          div.style.width = width + "px";
        }
      });
    }
    // Run on load and on resize
    window.addEventListener('DOMContentLoaded', matchDividersToHeadings);
    window.addEventListener('resize', matchDividersToHeadings);
    // ---------- Chart & DCA logic ----------

    // Constants and API keys
    const API_KEY = 'aa529084cdd675ed567d9c48c40c8a12';
    const ALPHA_VANTAGE_API_KEY = '7WPYDOV3ZYE7P4UF';

    // Elements & globals
    const allCities = [
      "New York, NY", "Atlanta, GA", "Phoenix, AZ", "Boston, MA",
      "San Francisco, CA", "Los Angeles, CA", "San Diego, CA", "Charlotte, NC",
      "Chicago, IL", "Cleveland, OH", "Denver, CO", "Dallas, TX", "Washington, DC",
      "Detroit, MI", "Miami, FL", "Tampa, FL", "Las Vegas, NV", "Minneapolis, MN",
      "Portland, OR", "Seattle, WA"
    ];
    const cityToFRED = {
      "New York, NY": "NYXRSA", "Atlanta, GA": "ATXRSA", "Phoenix, AZ": "PHXRSA",
      "Boston, MA": "BOXRSA", "San Francisco, CA": "SFXRSA", "Los Angeles, CA": "LXXRSA",
      "San Diego, CA": "SDXRSA", "Charlotte, NC": "CRXRSA", "Chicago, IL": "CHXRSA",
      "Cleveland, OH": "CEXRSA", "Denver, CO": "DNXRSA", "Dallas, TX": "DAXRSA",
      "Washington, DC": "WDXRSA", "Detroit, MI": "DEXRSA", "Miami, FL": "MIXRSA",
      "Tampa, FL": "TPXRSA", "Las Vegas, NV": "LVXRSA", "Minneapolis, MN": "MNXRSA",
      "Portland, OR": "POXRSA", "Seattle, WA": "SEXRSA"
    };

    // Main datasets and chart context
    let dcaChart;
    let hpiYearly = [], cpiYearly = [], dcaYears = [];
    let btcYears = [], btcPrices = [], btcLoaded = false, btcError = null;

    // Preload S&P 500 and CPI data
    let sp500Loaded = false, sp500Error = null;
    let sp500Data = null, sp500CpiRaw = null;


    // Chart controls
    const dcaForm = document.getElementById('dcaForm');
    const dcaStartYear = document.getElementById('dcaStartYear');
    const dcaResult = document.getElementById('dcaResult');

    // --- Data Fetch ---
async function fetchFRED(seriesId) {
  const base = `https://api.stlouisfed.org/fred/series/observations?series_id=${seriesId}&api_key=${API_KEY}&file_type=json&frequency=a&observation_start=1990-01-01`;
  const url = 'https://corsproxy.io/?' + encodeURIComponent(base);
  console.log('Starting FRED data fetch:', url);

  const res = await fetch(url);                                                // <-- single proxy
  console.log('FRED fetch response status:', res.status);
  if (!res.ok) {
    alert('Failed to fetch data from FRED via CORS proxy.');
    return [];
  }

  const raw = await res.text();
  console.log('FRED fetch raw response:', raw);

  try {
    const data = JSON.parse(raw);
    return data.observations.map(obs => ({
      year: new Date(obs.date).getFullYear(),
      value: parseFloat(obs.value)
    })).filter(x => !isNaN(x.value));
  } catch (e) {
    alert('Failed to parse FRED data! ' + e);
    return [];
  }
}


    // Populate cities in dropdown, sorted by HPI gain
    async function sortCitiesByHpiAndPopulateDropdown() {
      const citySelect = document.getElementById('cityYield');
      citySelect.innerHTML = '';
      const cityGainPairs = [];
      for (const city of allCities) {
        const fredCode = cityToFRED[city];
        const hpiRaw = await fetchFRED(fredCode);
        const years = hpiRaw.map(x => x.year).filter(y => y >= 1990);
        let hpiVals = years.map(y => hpiRaw.find(x => x.year == y)?.value || null);
        if (hpiVals.length < 2) continue;
        const base = hpiVals[0];
        hpiVals = hpiVals.map(v => v / base * 100);
        const hpiGain = ((hpiVals[hpiVals.length - 1] / hpiVals[0]) - 1) * 100;
        cityGainPairs.push({ city, hpiGain });
      }
      cityGainPairs.sort((a, b) => b.hpiGain - a.hpiGain);
      for (const { city, hpiGain } of cityGainPairs) {
        const opt = document.createElement('option');
        opt.value = city;
        opt.textContent = `${city} (${hpiGain.toFixed(1)}% HPI)`;
        citySelect.appendChild(opt);
      }
      citySelect.selectedIndex = 0;
    }

    // Load HPI and CPI data for selected city
    async function getHpiCpiData() {
      let city = cityYield.value || "New York, NY";
      let hpiCode = cityToFRED[city] || "USSTHPI";
      const [cpiRaw, hpiRaw] = await Promise.all([
        fetchFRED('CPIAUCSL'),
        fetchFRED(hpiCode)
      ]);
      const years = hpiRaw.map(x => x.year).filter(y => y >= 1990 && cpiRaw.some(c => c.year == y));
      hpiYearly = years.map(y => hpiRaw.find(x => x.year == y)?.value || null);
      cpiYearly = years.map(y => cpiRaw.find(x => x.year == y)?.value || null);
      dcaYears = years;
      // Normalize HPI
      const baseHPI = hpiYearly[0];
      hpiYearly = hpiYearly.map(v => v / baseHPI * 100);
      dcaStartYear.innerHTML = '';
      years.slice(0, -1).forEach(y => {
        dcaStartYear.innerHTML += `<option value="${y}">${y}</option>`;
      });
      dcaStartYear.value = years[0];
    }

    // Initialize city dropdown and first data, and preload S&P 500 & CPI
      window.addEventListener('DOMContentLoaded', async function() {
        await sortCitiesByHpiAndPopulateDropdown();
        await getHpiCpiData();
        updateDca();
        // Preload SP500 and CPI
        fetchSP500Yearly().then(data => {
          sp500Data = data;
          return fetchFRED('CPIAUCSL');
        }).then(cpi => {
          sp500CpiRaw = cpi;
          sp500Loaded = true;
          sp500Error = null;
        }).catch(e => {
          sp500Error = e.message || "Unknown error";
          sp500Loaded = false;
        });
      });


    // Real Estate DCA Logic
    function calcLumpSumCurve(startYear, lumpSum) {
      const idx0 = dcaYears.indexOf(+startYear);
      let nYears = dcaYears.length - idx0;
      let reVals = [], cashVals = [];
      let propertyValue = lumpSum, cashValue = lumpSum;
      for (let i = 0; i < nYears; i++) {
        if (i > 0) {
          propertyValue *= hpiYearly[idx0 + i] / hpiYearly[idx0 + i - 1];
          cashValue *= cpiYearly[idx0 + i - 1] / cpiYearly[idx0 + i];
        }
        reVals.push(propertyValue);
        cashVals.push(cashValue);
      }
      return {
        years: dcaYears.slice(idx0),
        invest: lumpSum,
        reVals,
        cashVals
      };
    }
function updateDca() {
  replaceChartCanvas();

  // Ensure HPI/CPI data loaded
  if (!hpiYearly.length || !cpiYearly.length || !dcaYears.length) return;

  const startYear = +dcaStartYear.value || dcaYears[0];
  const lumpSum = Math.min(10000000, +document.getElementById('dcaLumpSum').value || 0);
  const idx0 = dcaYears.indexOf(startYear);

  if (idx0 === -1) return;

  // Compute property and cash curves
  let propertyValue = lumpSum, cashValue = lumpSum;
  let reVals = [], cashVals = [];
  for (let i = 0; i < dcaYears.length - idx0; i++) {
    if (i > 0) {
      propertyValue *= hpiYearly[idx0 + i] / hpiYearly[idx0 + i - 1];
      cashValue *= cpiYearly[idx0 + i - 1] / cpiYearly[idx0 + i];
    }
    reVals.push(propertyValue);
    cashVals.push(cashValue);
  }
  const years = dcaYears.slice(idx0);
  const lastRE = reVals[reVals.length - 1] || lumpSum;
  const lastCash = cashVals[cashVals.length - 1] || lumpSum;
  const gainPct = ((lastRE / lumpSum - 1) * 100).toFixed(1);
  const cashPct = ((lastCash / lumpSum - 1) * 100).toFixed(1);

  dcaResult.innerHTML = `
    <div style="font-size:1.15em;font-weight:800;color:#fff;margin-bottom:0.7em;">
      Over the last ${years.length-1} years, your €${lumpSum.toLocaleString()} will be worth:
    </div>
    <div style="font-size:1.09em;text-align:center; color:#4faaff; font-weight:700; margin-bottom:0.3em;">
      Invested in Real Estate: €${Math.round(lastRE).toLocaleString()} (${gainPct > 0 ? "+" : ""}${gainPct}% ${gainPct >= 0 ? "gain" : "loss"})
    </div>
    <div style="font-size:1.09em;text-align:center; color:#ff2323; font-weight:700;">
      Only saved in cash: €${Math.round(lastCash).toLocaleString()} (${cashPct > 0 ? "+" : ""}${cashPct}% ${cashPct >= 0 ? "gain" : "loss"})
    </div>
  `;

  // ===== CHART.JS CODE (REQUIRED) =====
  dcaChart = new Chart(window.dcaChartCtx, {
    type: 'line',
    data: {
      labels: years,
      datasets: [
        {
          label: 'Real Estate Value (HPI)',
          data: reVals,
          borderColor: '#4faaff',
          backgroundColor: 'rgba(79,170,255,0.11)',
          fill: true,
          pointRadius: 0,
          tension: 0.21,
          borderWidth: 6,
        },
        {
          label: 'Cash (Inflation-Adjusted)',
          data: cashVals,
          borderColor: '#ff2323',
          backgroundColor: 'rgba(255,35,35,0.13)',
          fill: true,
          pointRadius: 0,
          tension: 0.19,
          borderWidth: 6,
        }
      ]
    },
    options: {
  plugins: {
    legend: { labels: { color: '#fff', font: { size: 22, weight: 'bold' } } },
    tooltip: { mode: 'index', intersect: false }
  },
  scales: {
    x: {
      display: false,  // REMOVE X axis labels & grid
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    },
    y: {
      display: false,  // REMOVE Y axis labels & grid
      min: 0,          // FORCE Y axis to start at zero to remove bottom gap
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    }
  },
  responsive: true,
  animation: { duration: 900 },
  maintainAspectRatio: false  // allow canvas height to control chart height fully
}


  });
  setTimeout(() => {
    if (dcaChart) dcaChart.resize();
  }, 60);
}


      function showRealEstate() {
    showingRealEstate = true;
    document.getElementById('btcForm').style.display = 'none';
    document.getElementById('sp500Form').style.display = 'none';
    document.getElementById('dcaForm').style.display = 'flex';
    if (dcaChart) { dcaChart.destroy(); dcaChart = null; }
    updateDca();
  }
  async function showBTC() {
    showingRealEstate = false;
    document.getElementById('dcaForm').style.display = 'none';
    document.getElementById('sp500Form').style.display = 'none';
    document.getElementById('btcForm').style.display = 'flex';
    if (dcaChart) { dcaChart.destroy(); dcaChart = null; }
    if (!btcLoaded && !btcError) {
      dcaResult.innerHTML = '<span style="color:#ffaa00;">Loading BTC prices...</span>';
      await fetchBTCPrices();
    }
    populateBtcYears();
    updateBtcDca();
  }
  async function showSP500() {
    showingRealEstate = false;
    document.getElementById('dcaForm').style.display = 'none';
    document.getElementById('btcForm').style.display = 'none';
    document.getElementById('sp500Form').style.display = 'flex';
    dcaResult.innerHTML = '<span style="color:#ffaa00;">Loading S&amp;P 500 and CPI data...</span>';
    const spData = await fetchSP500Yearly();
    const cpiRaw = await fetchFRED('CPIAUCSL');
    if (!spData || !cpiRaw) {
      dcaResult.innerHTML = '<span style="color:#ff2323;">Failed to fetch S&amp;P 500 or CPI data.</span>';
      return;
    }
    // Populate S&P years and update chart
    const years = spData.years;
const sp500StartYear = document.getElementById('sp500StartYear');
sp500StartYear.innerHTML = '';

// only show years that have CPI data (1990+)
const startYears = years.filter(y => y >= 1990);
startYears.slice(0, -1).forEach(y => {
  sp500StartYear.innerHTML += `<option value="${y}">${y}</option>`;
});
sp500StartYear.value = startYears[0];

    updateSp500Dca(spData, cpiRaw);
  }



    // Button event listeners
    document.getElementById('btnRealEstate').addEventListener('click', () => {
      setChartTitle('realestate');
      showRealEstate();
    });
    document.getElementById('btnBTC').addEventListener('click', () => {
      setChartTitle('btc');
      showBTC();
    });
    document.getElementById('btnSP500').addEventListener('click', () => {
      setChartTitle('sp500');
      showSP500();
    });

    // Chart tab titles
    const chartTitle = document.getElementById('chartTitle');
    const chartSubtitle = document.getElementById('chartSubtitle');
    function setChartTitle(mode) {
      if (mode === 'realestate') {
        chartTitle.textContent = 'Real Estate vs Cash (Live One Time Investment)';
        chartSubtitle.innerHTML = 'See what happens when you invest a lump sum in real estate vs. hold cash, using real <b>US HPI & CPI</b> data since 1990.';
      } else if (mode === 'btc') {
        chartTitle.textContent = 'Bitcoin vs Cash (Live One Time Investment)';
        chartSubtitle.innerHTML = 'See what happens when you invest a lump sum in Bitcoin vs. hold cash, using real <b>BTC & US CPI</b> data since 1990.';
      } else if (mode === 'sp500') {
        chartTitle.textContent = 'S&P 500 vs Cash (Live One Time Investment)';
        chartSubtitle.innerHTML = 'See what happens when you invest a lump sum in the S&P 500 vs. hold cash, using real <b>S&P 500 & US CPI</b> data since 1990.';
      }
    }
// ----------------- BTC AND SP500 DATA UTILS -----------------
async function fetchBTCPrices() {
  btcLoaded = false; btcError = null;
  try {
    const url = 'https://min-api.cryptocompare.com/data/v2/histoday?fsym=BTC&tsym=EUR&limit=2000';
    console.log('Starting BTC prices fetch:', url);
    const res = await fetch(url);
    console.log('BTC fetch response status:', res.status);
    if (!res.ok) throw new Error("HTTP error " + res.status);
    const data = await res.json();
    console.log('BTC fetch data:', data);

    const priceByYear = {};
    data.Data.Data.forEach(point => {
      const d = new Date(point.time * 1000);
      const year = d.getFullYear();
      const month = d.getMonth();
      const day = d.getDate();
      if (month === 0 && day === 1) {
        priceByYear[year] = point.close;
      } else if (!(year in priceByYear)) {
        priceByYear[year] = point.close;
      }
    });
    btcYears = Object.keys(priceByYear).map(Number).sort((a, b) => a - b);
    btcPrices = btcYears.map(y => priceByYear[y]);
    btcLoaded = true; btcError = null;
  } catch (e) {
    btcLoaded = false; btcError = e.message || "Unknown error";
  }
}

function populateBtcYears() {
  const btcStartYear = document.getElementById('btcStartYear');
  btcStartYear.innerHTML = '';
  const btcDropdownYears = btcYears.filter(y => dcaYears.includes(y));
  btcDropdownYears.slice(0, -1).forEach(y => {
    btcStartYear.innerHTML += `<option value="${y}">${y}</option>`;
  });
  btcStartYear.value = btcDropdownYears[0];
}

function updateBtcDca() {
  if (!btcLoaded || btcError) {
    dcaResult.innerHTML = btcError ? `<span style="color:#ff2323;">BTC data error: ${btcError}</span>` : '<span style="color:#ffaa00;">Loading BTC prices...</span>';
    return;
  }
  const btcStartYear = document.getElementById('btcStartYear');
  const btcLumpSumInput = document.getElementById('btcLumpSum');
  const start = +btcStartYear.value;
  const lumpSum = Math.min(10000000, +btcLumpSumInput.value || 0);
  if (btcYears.length === 0 || btcPrices.length === 0) return;

  const startIdx = btcYears.indexOf(start);
  if (startIdx === -1) return;

  let years = [];
  let btcVals = [];
  let cpiCashVals = [];
  let baseBTC = btcPrices[startIdx];

  for (let i = startIdx; i < btcYears.length; ++i) {
    let yr = btcYears[i];
    let cpiIdx = dcaYears.indexOf(yr);

    if (cpiIdx !== -1 && typeof btcPrices[i] !== 'undefined' && typeof cpiYearly[cpiIdx] !== 'undefined') {
      let btcValue = lumpSum * (btcPrices[i] / baseBTC);
      let cashValue;
      if (i === startIdx) {
        cashValue = lumpSum;
      } else {
        cashValue = cpiCashVals[cpiCashVals.length - 1] * (cpiYearly[cpiIdx - 1] / cpiYearly[cpiIdx]);
      }
      years.push(yr);
      btcVals.push(btcValue);
      cpiCashVals.push(cashValue);
    }
  }

  if (years.length === 0) return;

  const lastBTC = btcVals[btcVals.length - 1] || 0;
  const lastCash = cpiCashVals[cpiCashVals.length - 1] || lumpSum;
  const gainPct = ((lastBTC / lumpSum - 1) * 100).toFixed(1);
  const cashPct = ((lastCash / lumpSum - 1) * 100).toFixed(1);

  dcaResult.innerHTML = `
    <div style="font-size:1.15em;font-weight:800;color:#fff;margin-bottom:0.7em;">
      Over the last ${years.length-1} years, your €${lumpSum.toLocaleString()} will be worth:
    </div>
    <div style="font-size:1.09em;text-align:center;margin-bottom:0.3em; color:#fff; font-weight:700;">
      <span>Invested in <span style="color:#ffaa00;">BTC</span>: </span>
      <span>€${Math.round(lastBTC).toLocaleString()}</span>
      <span style="color:#ffaa00;"> (${gainPct > 0 ? "+" : ""}${gainPct}% ${gainPct >= 0 ? "gain" : "loss"})</span>
    </div>
    <div style="font-size:1.09em;text-align:center; color:#fff; font-weight:700;">
      <span>Only saved in cash: </span>
      <span>€${Math.round(lastCash).toLocaleString()}</span>
      <span style="color:#ff2323;"> (${cashPct > 0 ? "+" : ""}${cashPct}% ${cashPct >= 0 ? "gain" : "loss"})</span>
    </div>
  `;

replaceChartCanvas();

  replaceChartCanvas();
  dcaChart = new Chart(window.dcaChartCtx, {
    type: 'line',
    data: {
      labels: years,
      datasets: [
        {
          label: 'BTC Value (CryptoCompare)',
          data: btcVals,
          borderColor: '#ffaa00',
          backgroundColor: 'rgba(255,170,0,0.11)',
          fill: true,
          pointRadius: 0,
          tension: 0.21,
          borderWidth: 6,
        },
        {
          label: 'Cash (Inflation-Adjusted)',
          data: cpiCashVals,
          borderColor: '#ff2323',
          backgroundColor: 'rgba(255,35,35,0.13)',
          fill: true,
          pointRadius: 0,
          tension: 0.19,
          borderWidth: 6,
        }
      ]
    },
    options: {
  plugins: {
    legend: { labels: { color: '#fff', font: { size: 22, weight: 'bold' } } },
    tooltip: { mode: 'index', intersect: false }
  },
  scales: {
    x: {
      display: false,  // REMOVE X axis labels & grid
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    },
    y: {
      display: false,  // REMOVE Y axis labels & grid
      min: 0,          // FORCE Y axis to start at zero to remove bottom gap
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    }
  },
  responsive: true,
  animation: { duration: 900 },
  maintainAspectRatio: false  // allow canvas height to control chart height fully
}


  });
  setTimeout(() => {
    if (dcaChart) dcaChart.resize();
  }, 60);
}

// ---------- S&P 500 via Yahoo Finance (unlimited) ----------
async function fetchSP500Yearly() {
  const symbol = "%5EGSPC";              // ^GSPC URL-encoded
  const url = `https://query1.finance.yahoo.com/v8/finance/chart/${symbol}?range=max&interval=1mo&includePrePost=false`;
  const proxied = 'https://corsproxy.io/?' + encodeURIComponent(url);

  try {
    console.log("Starting S&P 500 fetch from Yahoo (proxied):", proxied);
    const res = await fetch(proxied);     // ← single proxy, CORS OK
    console.log("Yahoo fetch status:", res.status);
    if (!res.ok) throw new Error(`HTTP ${res.status}`);

    const json = await res.json();
    console.log("Yahoo chart data:", json);

    const result = json.chart?.result?.[0];
    if (!result) throw new Error("Unexpected Yahoo response shape");

    const { timestamp, indicators } = result;
    const closes = indicators.adjclose?.[0]?.adjclose;
    if (!timestamp || !closes) throw new Error("Missing price series");

    // convert to YYYY → last close that year
    const yearly = {};
    timestamp.forEach((ts, i) => {
      const d = new Date(ts * 1000);
      const y = d.getFullYear();
      yearly[y] = closes[i]; // later months overwrite earlier = keep Dec price
    });

    const years = Object.keys(yearly).map(Number).sort((a, b) => a - b);
    const prices = years.map(y => yearly[y]);

    return { years, prices };            // same shape you already use
  } catch (err) {
    console.error("Yahoo Finance S&P 500 fetch error:", err);
    return null;
  }
}

function updateSp500Dca(spData, cpiRaw) {
  const sp500StartYear = document.getElementById('sp500StartYear');
  const sp500LumpSumInput = document.getElementById('sp500LumpSum');
  const lumpSum = +sp500LumpSumInput.value || 50000;
  const startYear = +sp500StartYear.value;
  const idx0 = spData.years.indexOf(startYear);
  if (idx0 === -1) return;
  const years = spData.years.slice(idx0);
  const prices = spData.prices.slice(idx0);

    // build CPI series — carry the last known CPI forward for any missing years
  let lastCpi = null;
  const cpiValsRaw = years.map(y => {
    const found = cpiRaw.find(x => x.year == y);
    if (found) lastCpi = found.value;    // update when data exists
    return lastCpi;                      // reuse last value if missing
  });

  const baseCPI = cpiValsRaw[0];
  const cpiVals = cpiValsRaw.map(v => (v / baseCPI) * 100);

  const lastSP500 = lumpSum * (prices[prices.length - 1] / prices[0]);
  const inflationFactor = cpiVals[cpiVals.length - 1] / cpiVals[0];
  const lastCash = lumpSum / inflationFactor;
  const nominalGainPct = ((lastSP500 / lumpSum - 1) * 100).toFixed(1);
  const cashGainPct = ((lastCash / lumpSum - 1) * 100).toFixed(1);

  dcaResult.innerHTML = `
    <div style="font-size:1.15em;font-weight:800;color:#fff;margin-bottom:0.7em;">
      Over the last ${years.length - 1} years, your €${lumpSum.toLocaleString()} will be worth:
    </div>
    <div style="font-size:1.09em;text-align:center; color:#4faaff; font-weight:700; margin-bottom:0.3em;">
      Invested in S&amp;P 500: €${Math.round(lastSP500).toLocaleString()} (${nominalGainPct > 0 ? "+" : ""}${nominalGainPct}% gain)
    </div>
    <div style="font-size:1.09em;text-align:center; color:#ff2323; font-weight:700;">
      Only saved in cash: €${Math.round(lastCash).toLocaleString()} (${cashGainPct > 0 ? "+" : ""}${cashGainPct}% ${cashGainPct >= 0 ? "gain" : "loss"})
    </div>
  `;

  const cashAfterInflation = cpiVals.map((val, i) =>
    lumpSum * (cpiVals[0] / val)
  );
  const sp500Investment = prices.map((price, i) =>
    lumpSum * (price / prices[0])
  );

  if (dcaChart) {
    dcaChart.destroy();
    dcaChart = null;
  }
  replaceChartCanvas();
    dcaChart = new Chart(window.dcaChartCtx, {
    type: 'line',
    data: {
      labels: years,
      datasets: [
        {
          label: 'S&P 500 Value (Adj Close, Dec)',
          data: sp500Investment,
          borderColor: '#4faaff',
          backgroundColor: 'rgba(79,170,255,0.11)',
          fill: true,
          pointRadius: 0,
          tension: 0.21,
          borderWidth: 6,
        },
        {
          label: 'Cash (Inflation-Adjusted)',
          data: cashAfterInflation,
          borderColor: '#ff2323',
          backgroundColor: 'rgba(255,35,35,0.13)',
          fill: true,
          pointRadius: 0,
          tension: 0.19,
          borderWidth: 6,
        }
      ]
    },
    options: {
  plugins: {
    legend: { labels: { color: '#fff', font: { size: 22, weight: 'bold' } } },
    tooltip: { mode: 'index', intersect: false }
  },
  scales: {
    x: {
      display: false,  // REMOVE X axis labels & grid
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    },
    y: {
      display: false,  // REMOVE Y axis labels & grid
      min: 0,          // FORCE Y axis to start at zero to remove bottom gap
      grid: {
        drawBorder: false,
        drawTicks: false,
        display: false
      }
    }
  },
  responsive: true,
  animation: { duration: 900 },
  maintainAspectRatio: false  // allow canvas height to control chart height fully
}


  });
  setTimeout(() => {
    if (dcaChart) dcaChart.resize();
  }, 60);
}

// Real Estate input event listeners
document.getElementById('dcaLumpSum').addEventListener('input', updateDcaWithToggle);
document.getElementById('dcaStartYear').addEventListener('change', updateDcaWithToggle);
document.getElementById('cityYield').addEventListener('change', async function() {
  await getHpiCpiData();
  updateDcaWithToggle();
});

// BTC listeners
document.getElementById('btcStartYear').addEventListener('change', () => {
  if (!showingRealEstate) updateBtcDca();
});
document.getElementById('btcLumpSum').addEventListener('input', () => {
  if (!showingRealEstate) updateBtcDca();
});

// SP500 listeners
document.getElementById('sp500StartYear').addEventListener('change', () => {
  if (sp500Loaded && sp500Data && sp500CpiRaw) {
    updateSp500Dca(sp500Data, sp500CpiRaw);
  }
});
document.getElementById('sp500LumpSum').addEventListener('input', () => {
  if (sp500Loaded && sp500Data && sp500CpiRaw) {
    updateSp500Dca(sp500Data, sp500CpiRaw);
  }
});


// Unified update
function updateDcaWithToggle() {
  if (showingRealEstate) {
    updateDca();
  } else if (!showingRealEstate && document.getElementById('btcControls').style.display !== 'none') {
    updateBtcDca();
  } else if (!showingRealEstate && document.getElementById('sp500Controls').style.display !== 'none') {
    if (sp500Loaded && sp500Data && sp500CpiRaw) {
      updateSp500Dca(sp500Data, sp500CpiRaw);
    }
  }
}

  </script>
</body>
</html>

